{% load i18n admin_static %}
{% load staticfiles i18n compress %}
{% load humanize %}

{% block extrastyle %}
    <link href="{% static 'css/font-awesome.css' %}" rel="stylesheet" media="all">
    <link rel="stylesheet" type="text/css" href="{% static 'css/naic722/dashboard/schedulepopup.css' %}" media="all">
    <link href="{% static 'css/jquery-ui1.12.1.theme.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/jquery-ui1.12.1.structure.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/jquery.datetimepicker.css' %}" rel="stylesheet">
    <link href="{% static 'css/deleteconfirmation.css' %}" rel="stylesheet">
{% endblock %}

<form id="scheduleserviceform">
    <input type="hidden" name="rectype" id="rectype"  value="{{ rectype}}"/>
    <input type="hidden" name="assigntype" id="assigntype"  value="{{ assigntype}}"/>
    <input type="hidden" name="service_csrv_id" id="service_csrv_id"  value="{{ service.csrv_id }}"/>
    <input type="hidden" name="cres_id" id="cres_id"  value="{{ cres_id }}"/>
    <input type="hidden" name="cprs_id_responsible=" id="cprs_id_responsible="  value="{{ cprs_id_responsible }}"/>
    <input type="hidden" name="cprs_id_assigner=" id="cprs_id_assigner="  value="{{ cprs_id_assigner }}"/>


    <div id="scddiv">
        <div style="text-align: center">
            <i class="fa fa-users fa-3x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-form-img-titleheader"
               style="color: #073763"></i>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-form-titleheader">{{ rectype }} &nbsp;Reponsibility</span>
            <input type="hidden" name="recordtype" id="recordtype"  value="{{ rectype }}"/>
        </div>
        <div class="oh_scd_servkeeComponent oh_scd_servkeeHrule newscd-form-titleheader-horizontol"></div>
        <div>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-service">{{ rectype }}</span>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-service-content">{{ service.srvj.ctyp.ctyp_desc }}</span>
            <input type="hidden" name="recordtype_id" id="recordtype_id"  value="{{ service.csrv_id }}"/>
        </div>
        <div>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-duedate">Due date</span>
            <input type="text" value="{{ csrv_due_date }}" readonly
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-label-duedate-content" style="left: 277px"/>

            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-lastamtpaid">Scheduled:</span>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-lastamtpaid-content" style="left: 508px">
                 {% if service_schedule %}
                {{ service_schedule.cssc_service_date|date:"m/d/y H:m"  }}
                &nbsp;
                {% else %} - {% endif %}</span>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-duedate" style="top: 130px">Last serviced </span>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-lastamtpaid-content" style="font-weight: normal;left: 277px;top: 130px">
                 {% if csac_service_date_last %}
                {{ csac_service_date_last }}
                &nbsp
                {% else %} - {% endif %}</span>

        </div>

        <div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-serviceprovider" style="top: 183px" cellspacing="0"
                 cellpadding="0">
                Assigned To :
            </div>
{#            <span class="oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-serviceprovider" style="top:160px">#}
{#                {{ service_schedule.comp.name }}#}
{#            </span>#}
{#            <select id="vendorlist" name="vendorlist"#}
{#                    class="oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-serviceprovider">#}
{#                    {% if service_schedule %}#}
{#                   <option value="{{ service_schedule.comp_id }}" selected disabled>{{ service_schedule.comp.name }}</option>#}
{#                    {% endif %}#}
{#            </select>#}
            <select id="responsiblecontactlist" name="responsiblecontactlist"
                    class="oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-serviceprovider" style="top: 182px">
                {% ifequal assigntype 'mod'%}
{#                    {% if responsiblelist %}#}
{#                   <option value="{{ service_schedule.cprs_id_provider }}" selected>{{ service_schedule.cprs_id_provider.prsn.first_name }}&nbsp;{{ service_schedule.cprs_id_provider.prsn.last_name }}</option>#}
{#                    {% endif %}#}
                        {% for assigne in assignelist %}
{#                                {% if cres_id %}#}
{#                                    <option value="{{ responsible.cres_id }}" {% ifequal responsible.cprs_id cprs_id_responsible %}selected{% endifequal %}>{{ responsible.prsn.first_name}}&nbsp;{{ responsible.prsn.last_name }}</option>#}
{#                                {% else %}#}
                                    <option value="{{ assigne.cprs_id }}" {% ifequal assigne.cprs_id|stringformat:"s" cprs_id_responsible %}selected{% endifequal %}>
                                        {{ assigne.prsn.first_name}}&nbsp;{{ assigne.prsn.last_name }}</option>
{#                                {% endif %}#}

                        {% endfor %}
                {% else %}
                        {% for assigne in assignelist %}
                            {% if cres_id %}
                                <option value="{{ assigne.cprs_id }}" {% ifequal assigne.cprs_id|stringformat:"s" cprs_id_responsible %}selected{% endifequal %}>
                                    {{ assigne.prsn.first_name}}&nbsp;{{ assigne.prsn.last_name }}</option>
                            {% else %}
                                <option value="{{ assigne.cprs_id }}" {% ifequal assigne.cprs_id loggeduser_cprs_id %}selected{% endifequal %}>
                                    {{ assigne.prsn.first_name}}&nbsp;{{ assigne.prsn.last_name }}</option>
                            {% endif %}
                        {% endfor %}
                {% endifequal %}
{#                {% ifequal assigntyp 'mod'%}#}
{#                    {% if assignelist %}#}
{#                   <option value="{{ service_schedule.cprs_id_provider }}" selected>{{ service_schedule.cprs_id_provider.prsn.first_name }}&nbsp;{{ service_schedule.cprs_id_provider.prsn.last_name }}</option>#}
{#                    {% endif %}#}
{#                {% else %}#}
{#                    {% if assignelist %}#}
{#                        {% for assigne in assignelist %}#}
{#                            <option value="{{ assigne.cprs_id }}" >{{ assigne.prsn.first_name}}&nbsp;{{ assigne.prsn.last_name }}</option>#}
{#                        {% endfor %}#}
{#                    {% endif %}#}
{#                {% endifequal %}#}

{#                <option value="">Select contact</option>#}
            </select>
        </div>
        <div>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-note" style="top: 215px">Notes:</span>
            <div class="oh_scd_servkeeRelativeComponent newscd-textarea-note" style="top: 218px">
            {% ifequal assigntype 'mod'%}
                {% if responsiblerec %}
                     <textarea id="notes" name="notes" rows="4" cols="30" value="" style="word-wrap: break-word;top: 215px"
                          placeholder="Enter your notes related to the scheduled service">{{ responsiblerec.cres_note }}</textarea>
                    {% else %}
                <textarea id="notes" name="notes" rows="4" cols="30" value="" style="word-wrap: break-word;top: 215px"
                          placeholder="Enter your notes related to the scheduled service"></textarea>
                {% endif %}
             {% else %}
                <textarea id="notes" name="notes" rows="4" cols="30" value="" style="word-wrap: break-word;top: 215px"
                          placeholder="Enter your notes related to the scheduled service"></textarea>
            {% endifequal %}
            </div>
        </div>
{#        <div>#}
{#            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-contact" cellspacing="0"#}
{#                 cellpadding="0">#}
{#                Contact/Department:#}
{#            </div>#}
{##}
{#            <span class="oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-contact" style="left: 173px;top: 214px">#}
{#            {% if service_schedule %}#}
{#                {{ service_schedule.cprs_id_provider.prsn.first_name }}&nbsp;{{ service_schedule.cprs_id_provider.prsn.last_name }}#}
{#            {% endif %}#}
{#            </span>#}
{#            <select id="vendorcontactlist" name="vendorcontactlist"#}
{#                    class="oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-contact">#}
{#                {% ifequal assigntype 'mod'%}#}
{#                    {% if service_schedule %}#}
{#                   <option value="{{ service_schedule.cprs_id_provider }}" selected>{{ service_schedule.cprs_id_provider.prsn.first_name }}&nbsp;{{ service_schedule.cprs_id_provider.prsn.last_name }}</option>#}
{#                    {% endif %}#}
{#                {% endifequal %}#}
{#                <option value="">Select contact</option>#}
{#            </select>#}
{#            <i id="vendorcontactaddicon" name="vendorcontactaddicon"#}
{#               class="fa fa-plus-square-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-serviceprovider"#}
{#               style="color: #f72006"></i>#}
{#        </div>#}
{##}
{#        <div>#}
{#            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-phone" cellspacing="0"#}
{#                 cellpadding="0">#}
{#                Phone#}
{#                no:<br/></div>#}
{#         <span class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-phone" style="top: 266px;">#}
{#            {% if service_schedule %}#}
{#                {{ service_schedule.cprs_id_provider.prsn.office_phone }}#}
{#            {% endif %}#}
{#            </span>#}
{#             {% ifequal assigntype 'mod'%}#}
{#                    {% if service_schedule %}#}
{#                        <input id="phone" name="phone" type="text" value="{{ service_schedule.cprs_id_provider.prsn.office_phone }}" placeholder="Phone number"#}
{#                       class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-phone"/>#}
{#                    {% endif %}#}
{#             {% else %}#}
{#                <input id="phone" name="phone" type="text" value="" placeholder="Phone number"#}
{#                       class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-phone"/>#}
{#            {% endifequal %}#}
{#            <i class="fa fa-phone fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-phone"#}
{#               style="color: #080041;left: 255px"></i>#}
{#        </div>#}
{##}
{#        <div>#}
{#            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-email" cellspacing="0"#}
{#                 cellpadding="0">#}
{#                Email#}
{#                :<br/></div>#}
{#             <span class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email" style="top: 312px;">#}
{#            {% if service_schedule %}#}
{#                {{ service_schedule.cprs_id_provider.prsn.email }}#}
{#            {% endif %}#}
{#            </span>#}
{#            {% ifequal assigntype 'mod'%}#}
{#                    {% if service_schedule %}#}
{#                        <input id="email" name="email" type="text" value="{{ service_schedule.cprs_id_provider.prsn.email }}" placeholder="Email address"#}
{#                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email"/>#}
{#                    {% endif %}#}
{#             {% else %}#}
{#                <input id="email" name="email" type="text" value="" placeholder="Email address"#}
{#                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email"/>#}
{#            {% endifequal %}#}
{##}
{#            <i class="fa fa-envelope-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-email"#}
{#               style="color: #080041;left: 326px;top: 308px"></i>#}
{#        </div>#}
{#        <div>#}
{#            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-schedule">Scheduled:</span>#}
{##}
{#         <span class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule" style="top: 356px;">#}
{#            {% if service_schedule %}#}
{#                {{ service_schedule.cssc_service_date|date:"m/d/y H:m"  }}#}
{#            {% endif %}#}
{#            </span>#}

{#             {% ifequal assigntype 'mod'%}#}
{#                    {% if service_schedule %}#}
{#                        <input id="id_schdeduledinputcal" name="id_schdeduledinputcal" type="text" value="{{ service_schedule.cssc_service_date|date:"m/d/y H:m" }}"#}
{#                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule"/>#}
{#                    {% endif %}#}
{#             {% else %}#}
{#                <input id="id_schdeduledinputcal" name="id_schdeduledinputcal" type="text" value=""#}
{#                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule"/>#}
{#            {% endifequal %}#}

{#            <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"#}
{#               class="fa fa-calendar fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-schedule"#}
{#               style="color: #080041"></i>#}
{#            <span id="calendar_message" name="calendar_message"#}
{#                  class="oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-calmsg-schedule oh-alert-error apphelp-block"></span>#}
        </div>

{#        <div>#}
{#            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-note">Notes:</span>#}
{#            <div class="oh_scd_servkeeRelativeComponent newscd-textarea-note">#}
{#            {% ifequal assigntype 'mod'%}#}
{#                {% if service_schedule %}#}
{#                     <textarea id="notes" name="notes" rows="4" cols="50" value="" style="word-wrap: break-word"#}
{#                          placeholder="Enter your notes related to the scheduled service">{{ service_schedule.cssc_note}}</textarea>#}
{#                    {% endif %}#}
{#             {% else %}#}
{#                <textarea id="notes" name="notes" rows="4" cols="50" value="" style="word-wrap: break-word"#}
{#                          placeholder="Enter your notes related to the scheduled service"></textarea>#}
{#            {% endifequal %}#}
{#            </div>#}
{#        </div>#}

{% if service_schedule %}
        <div>
            <i class="fa fa-truck   fa-3x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newvendor-img-custexp"
               style="color: #073763"></i>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-custexp" cellspacing="0"
                 cellpadding="0">
                {{ service_schedule.comp.name }}<br/></div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeCanvas newscd-div-custexp-content" style="background-color: #fafdff;border: 1px solid #add8f5;">

{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-jurisdiction-value"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">NYC<br/></div>#}
{##}
{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-overall-value"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">Overall<br/></div>#}

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-arrivesontime" style="top: 6px"
                     cellspacing="0"
                     cellpadding="0"><i class="fa fa-user-o fa-1x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 "
               style="color: #073763">{% if service_schedule %}
                {{ service_schedule.cprs_id_provider.prsn.first_name }}&nbsp;{{ service_schedule.cprs_id_provider.prsn.last_name }}
            {% endif %}</i><br/></div>
{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-arrivesontime-value-jur"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">75%<br/></div>#}
{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-arrivesontime-value-ovr"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">85%<br/></div>#}

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-compontime" style="top: 37px"
                     cellspacing="0"
                     cellpadding="0"><i class="fa fa-phone fa-1x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 "
               style="color: #073763">{% if service_schedule %}
                {{ service_schedule.cprs_id_provider.prsn.office_phone }}
            {% endif %}</i><br/></div>
{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-compontime-value-jur"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">25%<br/></div>#}
{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-compontime-value-ovr"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">65%<br/></div>#}

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-satwithjob" style="top: 66px"
                     cellspacing="0"
                     cellpadding="0"><i class="fa fa-envelope-o fa-1x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 "
               style="color: #073763">{% if service_schedule %}
                {{ service_schedule.cprs_id_provider.prsn.email }}
            {% endif %}</i><br/></div>
{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-satwithjob-value-jur"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">75%<br/></div>#}
{#                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-satwithjob-value-ovr"#}
{#                     cellspacing="0"#}
{#                     cellpadding="0">95%<br/></div>#}

            </div>
{#                <div>#}
{#                    <div title="star rating">#}
{#                        <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"#}
{#               class="fa fa-star fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-biz-rating-star1"#}
{#               style="color: #ff0016"></i>#}
{#                        <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"#}
{#               class="fa fa-star fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-biz-rating-star2"#}
{#               style="color: #ff0016"></i>#}
{#                        <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"#}
{#               class="fa fa-star-half-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-biz-rating-star3"#}
{#               style="color: #ff0016"></i>#}
{#                        <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"#}
{#               class="fa fa-star-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-biz-rating-star4"#}
{#               style="color: #ff0016"></i>#}
{#                        <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"#}
{#               class="fa fa-star-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-biz-rating-star5"#}
{#               style="color: #ff0016"></i>#}
{#                    </div>#}
{#                     <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-div-biz-rating">333 reviews</span>#}
{#                </div>#}
        </div>
{% endif %}
        <div style="margin-top:302px;text-align: right;margin-right: 100px">
              {% ifequal assigntype 'mod'%}
                {% if cprs_id_responsible %}
                    <div class="btn">
                          <div class="btn-back" style="display: inline">
                            <p>Are you sure you want to do that?</p>
                            <button class="yes">Yes</button>
                            <button class="no">No</button>
                          </div>
                            <div class="btn-front" style="margin-left:110px;margin-top:5px;font-size: 14px;color: red;background-color: transparent; border: transparent;font-weight: bolder;"><i class="fa fa-trash-o fa-2x"
                            style="color: Red"></i>&nbsp;Delete</button>
                            </div>
                    </div>
                    <button type="button" id="updateresponsible" class="ui-button ui-corner-all ui-widget"
                    style="font-size: 14px; margin-left: 4px;color: #1E9E74;background-color: transparent; border: transparent;font-weight: bolder;">
                        <i class="fa fa-pencil-square-o fa-2x" style="color: #1E9E74"></i>&nbsp;Update
                    </button>
{#                    <button type="button" id="deleteschedule" class="ui-button ui-corner-all ui-widget"#}
{#                    style="font-size: 14px; margin-left: 4px;color: Red;background-color: transparent; border: transparent;font-weight: bolder;">#}
{#                        <i class="fa fa-trash-o fa-2x"#}
{#               style="color: Red"></i>&nbsp;Delete Schedule</button>#}
                    {% endif %}
             {% else %}
                  <button type="button" id="createresponsible" class="ui-button ui-corner-all ui-widget"
                    style="font-size: 14px; margin-left: 4px;color: #1E9E74;background-color: transparent; border: transparent;font-weight: bolder;">
                        <i class="fa fa-floppy-o fa-2x" style="color: #1E9E74"></i>&nbsp;Assign
                    </button>
            {% endifequal %}

        <button type="button" id="cancel" class="ui-button ui-corner-all ui-widget"
                    style="font-size: 14px; margin-left: 4px;color: #0E63B6;background-color: transparent; border: transparent;font-weight: bolder;">
                        <i class="fa fa-times-circle fa-2x" style="color: #0E63B6"></i>&nbsp;Cancel
                    </button>
        </div>
        <div style="margin-top:0px;text-align: left;margin-right: 100px">
        <span id="form_action_message" name="form_action_message"></span>
        </div>
    </div>
    <div id="dialogschedulepopnewvendor">
        <iframe id="newvendorIframe" src="" width="" height=""
                style="border: none;margin-top: -1px;margin-left: -3px"></iframe>
    </div>

</form>
{% block extrajs %}
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery-3.1.1.min.js"></script>

    {% compress js %}
        <script src="{% static 'js/jquery-ui1.12.1.js' %}"></script>
        <script src="{% static 'js/moment-2.17.1.min.js' %}"></script>
        <script src="{% static 'js/jquery.datetimepicker.js' %}"></script>
        <script src="{% static 'js/deleteconfirmation.js' %}"></script>
    {% endcompress %}

    <script type="text/javascript" language="javascript">
    {% ifequal assigntype 'mod'%}
                {% if cprs_id_responsible %}

    var btn = document.querySelector('.btn');
var btnFront = btn.querySelector('.btn-front'), btnYes = btn.querySelector('.btn-back .yes'), btnNo = btn.querySelector('.btn-back .no');
btnFront.addEventListener('click', function (event) {
    var mx = event.clientX - btn.offsetLeft, my = event.clientY - btn.offsetTop;
    var w = btn.offsetWidth, h = btn.offsetHeight;
    var directions = [
        {
            id: 'top',
            x: w / 2,
            y: 0
        },
        {
            id: 'right',
            x: w,
            y: h / 2
        },
        {
            id: 'bottom',
            x: w / 2,
            y: h
        },
        {
            id: 'left',
            x: 0,
            y: h / 2
        }
    ];
    directions.sort(function (a, b) {
        return distance(mx, my, a.x, a.y) - distance(mx, my, b.x, b.y);
    });
    btn.setAttribute('data-direction', directions.shift().id);
    btn.classList.add('is-open');

});
btnYes.addEventListener('click', function (event) {
    btn.classList.remove('is-open');
    // alert('Yes Cliked');
    if (form_valid() == true) {
                perform_delete()
            }
    event.preventDefault();
});
btnNo.addEventListener('click', function (event) {
    btn.classList.remove('is-open');
    // alert('No clicked');
    event.preventDefault();
});
function distance(x1, y1, x2, y2) {
    var dx = x1 - x2;
    var dy = y1 - y2;
    return Math.sqrt(dx * dx + dy * dy);
}
{% endif %}
    {% endifequal %}
{#        $(document).ready(function () {#}
{##}
{#            var btn = document.querySelector( '.btn' );#}
{##}
{#            var btnFront = btn.querySelector( '.btn-front' ),#}
{#                btnYes = btn.querySelector( '.btn-back .yes' ),#}
{#                btnNo = btn.querySelector( '.btn-back .no' );#}
{##}
{#            $("#dialogschedulepopnewvendor").dialog({#}
{#                modal: true,#}
                {#                minHeight: 530,#}
                {#                minWidth: 634,#}
{#                minHeight: 520,#}
{#                minWidth: 670,#}
{#                resizable: false,#}
{#                draggable: false,#}
{#                autoOpen: false,#}
{#                dialogClass: "no-close",#}
{#                position: {#}
{#                    my: 'center',#}
{#                    at: 'center'#}
{#                },#}
{#            });#}
{##}
{#            $("#id_schdeduledinputcal").datepicker({#}
{#            $("#id_schdeduledinputcal").datetimepicker({#}
{##}
{#                minDate: 0,#}
{#                showButtonPanel: true,#}
{#                changeMonth: true,#}
{#                changeYear: true,#}
{#                showAnim: "fold",#}
                {#                buttonImage: "images/calendar.gif",#}
{#                // The hidden field to receive the date#}
{#                format:'m/d/y H:i',#}
{#                format:'H:i',#}
{#                altField: "#id_schdeduledinputcal",#}
{#                // The format you want#}
{#                altFormat: "mm/dd/y",#}
{#                // The format the user actually sees#}
{#                dateFormat: "mm/dd/y",#}
{#                "minTime":"00:00",#}
{#                "maxTime":"23:59",#}
{##}
{#                onSelect: function (date) {#}
{##}
{#                    // Your CSS changes, just in case you still need them#}
{#                    $('a.ui-state-default').removeClass('ui-state-highlight');#}
{#                    $(this).addClass('ui-state-highlight');#}
{#                }#}
{#            });#}
{##}
{##}
{#        });#}


        {#        $('#id_schdeduledcalicon').click(function () {#}
        {##}
        {#            $("#id_schdeduledinputcal").datepicker();#}
        {#        });#}

        $('#createschedule').click(function () {
            {#        alert('1');#}
            $("#dialogschedulepop").dialog("close");
            window.close();
        });

        function schedulepopupnewvendor(url) {
            $('#scddiv').hide();
            $('.ui-button.ui-corner-all.ui-widget').css('font-size', '14px');
            $('.ui-button.ui-corner-all.ui-widget').css('margin-left', '4px');

            $.ajax({
                url: url,
                success: function (data) {

                    console.log('url', url);
                    $("#scheduleIframe").attr("visibility", "hidden");
                    $("#dialogschedulepop").dialog("close");
                    $("#newvendorIframe").attr("src", url);
                    $("#newvendorIframe").attr("width", 670);
                    $("#newvendorIframe").attr("height", 520);
                    $("#newvendorIframe").attr("style", "border:None;font-family: Open Sans, sans-serif;");
                    $("#dialogschedulepopnewvendor").dialog("open");
                }
            });
            return false;
        }

        $('#cancel').click(function () {
            if (window.parent.$("#dialogcoordinatepop").dialog("isOpen") == true) {
                window.parent.$("#dialogcoordinatepop").dialog("close");
{#                window.parent.location.reload();#}
            }
        });




        function form_valid() {
            var form_valid = true;
            console.log($("#responsiblecontactlist option:selected").val());
            if ($("#responsiblecontactlist option:selected").val() == '') {
                form_valid = false;
                $('#responsiblecontactlist').addClass("oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-serviceprovider has-danger");

            } else {
                $('#responsiblecontactlist').removeClass("has-danger");
            }

            if ($('input:hidden[name=service_csrv_id]').val() == '' ) {
                    form_valid = false;
                    $('#responsiblecontactlist').addClass("oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email has-danger");
                }

            return form_valid;
        }

        function perform_updates(action) {

            console.log('All welll for Data updated');
                document.getElementById("form_action_message").innerHTML = "";

                service_csrv_id = $('input:hidden[name=service_csrv_id]').val();
                cres_id = $('input:hidden[name=cres_id]').val();
                responsible = $("#responsiblecontactlist option:selected").val();
                notes = document.getElementById('notes').value;

                console.log('Form Valid -AJAX- Create Responsible call,responsible',responsible);
                $.ajax({
                    url: '/app/schedule/ajax_complianceservice_addnewresponsible',
                    data: {
                        'action':action,
                        'cres_id':cres_id,
                        'csrv_id':service_csrv_id,
                        'responsible': responsible,
                        'notes': notes

                    },
                    dataType: 'json',
                    success: function (response_data) {
                        console.log(response_data.result);
                        if (response_data.result == 'success') {
                            window.parent.$("#dialogcoordinatepop").dialog("close");
                            window.parent.location.reload();
                        }

                    }
                });
        }

        $('#createresponsible').click(function () {
            if (form_valid() == true) {
                 perform_updates('create')
            }
        });

        $('#updateresponsible').click(function () {
            if (form_valid() == true) {
                 perform_updates('update')
            }
        });
     function perform_delete() {
              if (form_valid() == true) {
                 perform_updates('delete')
            }
        }

        $('#deleteschedule').click(function () {
            if (form_valid() == true) {
                perform_delete()
            }
        });
    </script>
{% endblock %}

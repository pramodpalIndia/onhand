{% load i18n admin_static %}
{% load staticfiles i18n compress %}
{% load humanize %}

{% block extrastyle %}
    <link href="{% static 'css/font-awesome.css' %}" rel="stylesheet" media="all">
    <link rel="stylesheet" type="text/css" href="{% static 'css/naic722/dashboard/schedulepopup.css' %}" media="all">
    <link href="{% static 'css/jquery-ui1.12.1.theme.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/jquery-ui1.12.1.structure.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/jquery.datetimepicker.css' %}" rel="stylesheet">
    <link href="{% static 'css/deleteconfirmation.css' %}" rel="stylesheet">
{% endblock %}

<form id="scheduleserviceform">
    <input type="hidden" name="actiontype" id="actiontype"  value="{{ actiontype}}"/>
    <input type="hidden" name="modified_cssc_id" id="modified_cssc_id"  value="{{ cssc_id}}"/>
    <input type="hidden" name="cres_id" id="cres_id"  value="{{ cres_id }}"/>
    <input type="hidden" name="basi_code" id="basi_code"  value="{{ basi_code }}"/>
    <input type="hidden" name="complianceservice_id" id="complianceservice_id"  value="{{ service.csrv_id }}"/>
    <div id="scddiv">
        <div style="text-align: center">
            <i class="fa fa-truck fa-3x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-form-img-titleheader"
               style="color: #073763"></i>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-form-titleheader">{{ rectype }}&nbsp;Action </span>
            <input type="hidden" name="recordtype" id="recordtype"  value="{{ rectype }}"/>
        </div>
        <div class="oh_scd_servkeeComponent oh_scd_servkeeHrule newscd-form-titleheader-horizontol"></div>
        <div>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-service">{{ rectype }}</span>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-service-content">{{ service.srvj.ctyp.ctyp_desc }}</span>
            <input type="hidden" name="recordtype_id" id="recordtype_id"  value="{{ service.csrv_id }}"/>
        </div>
        <div>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-duedate">Due date</span>
            <input type="text" value="{{ csrv_due_date }}" readonly
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-label-duedate-content"/>

            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-lastamtpaid">Last Amount paid:</span>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-lastamtpaid-content">{% if csac_price_last != 'None' %}
                $&nbsp;
                {{ csac_price_last }} {% else %} - {% endif %}</span>
                {% if csac_price_last !=  'None' %}
                    {% if off_from_avg <= 0 %}
                        <i
                                class="fa fa-thumbs-o-up fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-lastamt-valueformoney"
                                style="color: #72a525"></i>
                    {% else %}
                        <i
                                class="fa fa-thumbs-o-down fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-lastamt-valueformoney"
                                style="color: red"></i>
                    {% endif %}
                {% endif %}
        </div>

        <div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-serviceprovider" cellspacing="0"
                 cellpadding="0">
                Service
                provider :
            </div>
            <select id="vendorlist" name="vendorlist"
                    class="oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-serviceprovider">
                {% if service_schedule %}
                         {% for serviceprovider in serviceproviderlist %}
                            <option value="{{ serviceprovider.comp_id }}" {% ifequal serviceprovider.comp_id service_schedule.comp_id %}selected{% endifequal %}>{{ serviceprovider.comp_name}}</option>
                        {% endfor %}
{#                   <option value="{{ service_schedule.comp_id }}" selected>{{ service_schedule.comp.name }}</option>#}
                {% else %}
                    {% ifequal lastactioncomplianceexists False %}
                            <option value="">Select Service Provider</option>
                        {% endifequal %}>
                    {% for serviceprovider in serviceproviderlist %}
                        <option value="{{ serviceprovider.comp_id }}"
                                {% ifequal lastactioncomplianceexists True %}
                                    {% ifequal serviceprovider.comp_id|stringformat:"s"  lastactioncompliance.comp_id_id  %}selected{% endifequal %}
                                {% endifequal %}>
                            {{ serviceprovider.comp_name}}</option>
                    {% endfor %}
                {% endif %}

            </select>
            <a href=""
               onclick="return  schedulepopupnewvendor('/app/newvendor/?type={{ rectype }}&service={{ record.csrv_id }}&scdtyp=newvendor')"
               class="dismiss" onclick='javascript:openDialog()' title="Add new Service Provider">
                <i id="vendoraddicon" name="vendoraddicon"
                   class="fa fa-plus-square-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-contact"
                   style="color: #f72006"></i>
            </a>

            <i id="vendorcontactrefreshicon" name="vendorcontactrefreshicon"
               class="fa fa-refresh fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-contact"
               style="color: #1D9D73;visibility: hidden;font-weight: bold;margin-left: 5px;"></i>
        </div>

        <div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-contact" cellspacing="0"
                 cellpadding="0">
                Contact/Department:
            </div>

            <i id="vendorcontactaddicon" name="vendorcontactaddicon"
               onclick="return  schedulepopupnewvendorcontact('/app/newvendorcontact/?type={{ rectype }}&service={{ record.csrv_id }}&scdtyp=newvendorcontact')"
               class="fa fa-plus-square-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-serviceprovider"
               style="color: #f72006"></i>
            <select id="vendorcontactlist" name="vendorcontactlist"
                    class="oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-contact">

             {% if service_schedule %}
                         {% for contacts in vendorcontactlist %}
                            <option value="{{ contacts.cprs_id }}" {% ifequal contacts.cprs_id|stringformat:"s" service_schedule.cprs_id_provider|stringformat:"s"  %}selected{% endifequal %}>
                                {{ contacts.prsn_name}}</option>
                        {% endfor %}
                {% else %}
                    {% ifequal lastactioncomplianceexists False %}
                            <option value="" selected>Select Contact</option>
                        {% endifequal %}>
                        {% for contacts in lastactionvendorcontactlist %}
                        <option value="{{ contacts.cprs_id}}"
                                {% ifequal lastactioncomplianceexists True %}
                                    {% ifequal contacts.cprs_id|stringformat:"s"  lastactioncompliance.cprs_id_id|stringformat:"s"  %}selected{% endifequal %}
                                {% endifequal %}>
                            {{ contacts.prsn_name}}</option>
                    {% endfor %}
             {% endif %}

{#                {% ifequal actiontype 'mod'%}#}
{#                    {% if service_schedule %}#}
{#                        <option value="{{ service_schedule.cprs_id_provider }}" selected>{{ service_schedule.cprs_id_provider.prsn.first_name }}&nbsp;{{ service_schedule.cprs_id_provider.prsn.last_name }}</option>#}
{#                        {% for contacts in vendorcontactlist %}#}
{#                            <option value="{{ contacts.cprs_id }}" {% ifequal contacts.cprs_id|stringformat:"s" service_schedule.cprs_id_provider|stringformat:"s"  %}selected{% endifequal %}>#}
{#                                {{ contacts.prsn_name}}</option>#}
{#                        {% endfor %}#}
{#                    {% endif %}#}
{#                {% else %}#}
{#                <option value="">Select contact</option>#}
{#            {% endifequal %}#}
            </select>
        </div>

        <div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-phone" cellspacing="0"
                 cellpadding="0">
                Phone
                no:<br/></div>
             {% ifequal actiontype 'mod'%}
                    {% if service_schedule %}
                        <input id="phone" name="phone" type="text" value="{{ service_schedule.cprs_id_provider.prsn.office_phone }}" placeholder="Phone number"
                       class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-phone"/>
                    {% endif %}
             {% else %}
                 {% if service_schedule %}
                        <input id="phone" name="phone" type="text" value="{{ service_schedule.cprs_id_provider.prsn.office_phone }}" placeholder="Phone number"
                       class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-phone"/>
                 {% else %}
                <input id="phone" name="phone" type="text" value="{% ifequal lastactioncomplianceexists True %}{{ lastactioncompliance.prsn_mobile_phone }}{% endifequal %}" placeholder="Phone number"
                       class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-phone"/>
                 {% endif %}

            {% endifequal %}
            <i class="fa fa-phone fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-phone"
               style="color: #080041"></i>
        </div>

        <div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-email" cellspacing="0"
                 cellpadding="0">
                Email
                :<br/></div>
            {% ifequal actiontype 'mod'%}
                    {% if service_schedule %}
                        <input id="email" name="email" type="text" value="{{ service_schedule.cprs_id_provider.prsn.email }}" placeholder="Email address"
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email"/>
                    {% endif %}
             {% else %}
                {% if service_schedule %}
                        <input id="email" name="email" type="text" value="{{ service_schedule.cprs_id_provider.prsn.email }}" placeholder="Email address"
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email"/>
                {% else %}
                <input id="email" name="email" type="text" value="{% ifequal lastactioncomplianceexists True %}{{ lastactioncompliance.prsn_email }}{% endifequal %}" placeholder="Email address"
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email"/>
                {% endif %}
            {% endifequal %}

            <i class="fa fa-envelope-o fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-email"
               style="color: #080041"></i>
        </div>
    <div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-email" cellspacing="0"
                 cellpadding="0" style="top: 308px">
                Price
                :<br/>
            </div>
            {% ifequal actiontype 'mod'%}
                    {% if service_schedule %}
                        <input id="price" name="price" type="text" value="{{ service_schedule.csac_price }}" placeholder="Amount paid in $"
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email" style="top: 308px"/>
                    {% endif %}
             {% else %}
                <input id="price" name="price" type="text" value="" placeholder="Amount in $"
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email" style="top: 308px;"/>
            {% endifequal %}
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-email" cellspacing="0"
                 cellpadding="0" style="top: 308px;left: 369px;">
                Frequency:
            </div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-email" cellspacing="0"
                 cellpadding="0" style="top: 308px;left: 464px;">
                {{ basis_description.basi_desc }}
{#                <i class="fa fa-hourglass-start fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-email"#}
{#               style="color: #080041;top: -3px;left: 90px;"></i>#}
            </div>
    </div>
        <div>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-schedule" style="top: 348px;font-size: 13px;">Action date:</span>
             {% ifequal actiontype 'mod'%}
                    {% if service_schedule %}
                        <input id="id_schdeduledinputcal" name="id_schdeduledinputcal" type="text" value="{{ service_schedule.cssc_service_date|date:"m/d/y H:m" }}"
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule" style="top: 348px"/>
                    {% endif %}
             {% else %}
                <input id="id_schdeduledinputcal" name="id_schdeduledinputcal" type="text" value=""
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule" style="top: 348px"/>
            {% endifequal %}

            <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"
               class="fa fa-calendar fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-schedule"
               style="color: #080041;top: 346px"></i>
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-schedule" style="left: 369px;top: 348px;font-size: 13px;">Next Due:</span>
             {% ifequal actiontype 'mod'%}
                    {% if service_schedule %}
                        <input id="id_schdeduledinputcal" name="id_schdeduledinputcal" type="text" value="{{ service_schedule.cssc_service_date|date:"m/d/y H:m" }}"
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule" style="left: 464px;top: 348px"/>
                    {% endif %}
             {% else %}
                <input id="id_nextservicedate" name="id_nextservicedate" type="text" value="" {% ifequal basi_code|stringformat:"s" "ONCE"%}readonly{% endifequal %}
                   class="oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule" style="left: 464px;top: 348px"/>
            {% endifequal %}

            <i id="id_schdeduledcalicon" name="id_schdeduledcalicon"
               class="fa fa-calendar fa-2x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-img-schedule"
               style="color: #080041;left:620px;top: 346px"></i>

            <span id="calendar_message" name="calendar_message"
                  class="oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-calmsg-schedule oh-alert-error apphelp-block" style="left: 171px;top: 340px"></span>
        </div>

        <div style="top: 390px">
            <span class="oh_scd_servkeeComponent oh_scd_servkeeLabel newscd-label-note" style="top: 390px;font-size: 13px;">Service Note:</span>
            <div class="oh_scd_servkeeRelativeComponent newscd-textarea-note" style="top: 390px">
            {% ifequal actiontype 'mod'%}
                {% if service_schedule %}
                     <textarea id="notes" name="notes" rows="4" cols="50" value="" style="word-wrap: break-word"
                          placeholder="Enter your notes related to the service been performed">{{ service_schedule.cssc_note}}</textarea>
                    {% endif %}
             {% else %}
                <textarea id="notes" name="notes" rows="4" cols="50" value="" style="word-wrap: break-word"
                          placeholder="Enter your notes related to the service been performed"></textarea>
            {% endifequal %}
            </div>
        </div>



        <div>
            <i class="fa fa-commenting-o   fa-3x oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newvendor-img-custexp"
               style="color: #073763"></i>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeParagraph newscd-label-custexp" cellspacing="0"
                 cellpadding="0" style="width: 200px">Your Feedback on the service<br/></div>
            <div class="oh_scd_servkeeComponent oh_scd_servkeeCanvas newscd-div-custexp-content" style="background-color: #fff2e5">

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-jurisdiction-value"
                     cellspacing="0"
                     cellpadding="0">Yes<br/></div>

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-overall-value"
                     cellspacing="0"
                     cellpadding="0">No<br/></div>

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-arrivesontime"
                     cellspacing="0"
                     cellpadding="0">Arrived on time<br/></div>
                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-arrivesontime-value-jur"
                     cellspacing="0"
                     cellpadding="0"><input type="radio" id="feedback1yes" name="feedback1" value="Yes" ><br/></div>
                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-arrivesontime-value-ovr"
                     cellspacing="0"
                     cellpadding="0"><input type="radio" id="feedback1no" name="feedback1" value="No" ><br/></div>

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-compontime"
                     cellspacing="0"
                     cellpadding="0">Completed on time<br/></div>
                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-compontime-value-jur"
                     cellspacing="0"
                     cellpadding="0"><input type="radio" id="feedback2yes" name="feedback2" value="Yes" ><br/></div>
                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-compontime-value-ovr"
                     cellspacing="0"
                     cellpadding="0"><input type="radio" id="feedback2no" name="feedback2" value="No" ><br/></div>

                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-satwithjob"
                     cellspacing="0"
                     cellpadding="0">Satisfied with Job<br/></div>
                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-satwithjob-value-jur"
                     cellspacing="0"
                     cellpadding="0"><input type="radio" id="feedback3yes" name="feedback3" value="Yes" ><br/></div>
                <div class="oh_scd_servkeeRelativeComponent oh_scd_servkeeParagraph newscd-label-custexp-satwithjob-value-ovr"
                     cellspacing="0"
                     cellpadding="0"><input type="radio" id="feedback3no" name="feedback3" value="No" ><br/></div>

            </div>

             <span id="feedback_message" name="feedback_message"
                  class="oh_scd_servkeeComponent oh_scd_servkeeIcon rotate360 newscd-calmsg-schedule oh-alert-error apphelp-block" style="left: 436px;top: 288px"></span>
        </div>
        <div style="margin-top:470px;text-align: right;margin-right: 100px">
              {% ifequal actiontype 'mod'%}
                {% if service_schedule %}
                    <div class="btn">
                          <div class="btn-back" style="display: inline">
                            <p>Are you sure you want to do that?</p>
                            <button class="yes">Yes</button>
                            <button class="no">No</button>
                          </div>
                            <div class="btn-front" style="font-size: 14px; margin-left: 4px;color: red;background-color: transparent; border: transparent;font-weight: bolder;"><i class="fa fa-trash-o fa-2x"
                            style="color: Red"></i>&nbsp;Delete</button>
                            </div>
                    </div>
                    <button type="button" id="updateaction" class="ui-button ui-corner-all ui-widget"
                    style="font-size: 14px; margin-left: 4px;color: #1E9E74;background-color: transparent; border: transparent;font-weight: bolder;">
                        <i class="fa fa-pencil-square-o fa-2x" style="color: #1E9E74"></i>&nbsp;Update
                    </button>
{#                    <button type="button" id="deleteschedule" class="ui-button ui-corner-all ui-widget"#}
{#                    style="font-size: 14px; margin-left: 4px;color: Red;background-color: transparent; border: transparent;font-weight: bolder;">#}
{#                        <i class="fa fa-trash-o fa-2x"#}
{#               style="color: Red"></i>&nbsp;Delete Schedule</button>#}
                    {% endif %}
             {% else %}
                  <button type="button" id="createaction" class="ui-button ui-corner-all ui-widget"
                    style="font-size: 14px; margin-left: 4px;color: #1E9E74;background-color: transparent; border: transparent;font-weight: bolder;">
                        <i class="fa fa-pencil-square-o fa-2x" style="color: #1E9E74"></i>&nbsp;Action
                    </button>
            {% endifequal %}

        <button type="button" id="cancel" class="ui-button ui-corner-all ui-widget"
                    style="font-size: 14px; margin-left: 4px;color: #0E63B6;background-color: transparent; border: transparent;font-weight: bolder;">
                        <i class="fa fa-times-circle fa-2x" style="color: #0E63B6"></i>&nbsp;Cancel
                    </button>
        </div>
        <div style="margin-top:0px;text-align: left;margin-right: 100px">
        <span id="form_action_message" name="form_action_message"></span>
        </div>
    </div>
    <div id="dialogschedulepopnewvendor">
        <iframe id="newvendorIframe" src="" width="" height=""
                style="border: none;margin-top: -1px;margin-left: -3px"></iframe>
    </div>
    <div id="dialogschedulepopnewvendorcontact">
        <iframe id="newvendorcontactIframe" src="" width="" height=""
                style="border: none;margin-top: -1px;margin-left: -3px"></iframe>
    </div>
</form>
{% block extrajs %}
    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery-3.1.1.min.js"></script>

    {% compress js %}
        <script src="{% static 'js/jquery-ui1.12.1.js' %}"></script>
        <script src="{% static 'js/moment-2.17.1.min.js' %}"></script>
        <script src="{% static 'js/jquery.datetimepicker.js' %}"></script>
        <script src="{% static 'js/deleteconfirmation.js' %}"></script>
        <script src="{% static 'js/jquery.mask.min.js' %}"></script>
        <script src="{% static 'js/jquery.maskMoney.min.js' %}"></script>
    {% endcompress %}

    <script type="text/javascript" language="javascript">
    {% ifequal actiontype 'mod'%}
                {% if service_schedule %}

    var btn = document.querySelector('.btn');
var btnFront = btn.querySelector('.btn-front'), btnYes = btn.querySelector('.btn-back .yes'), btnNo = btn.querySelector('.btn-back .no');
btnFront.addEventListener('click', function (event) {
    var mx = event.clientX - btn.offsetLeft, my = event.clientY - btn.offsetTop;
    var w = btn.offsetWidth, h = btn.offsetHeight;
    var directions = [
        {
            id: 'top',
            x: w / 2,
            y: 0
        },
        {
            id: 'right',
            x: w,
            y: h / 2
        },
        {
            id: 'bottom',
            x: w / 2,
            y: h
        },
        {
            id: 'left',
            x: 0,
            y: h / 2
        }
    ];
    directions.sort(function (a, b) {
        return distance(mx, my, a.x, a.y) - distance(mx, my, b.x, b.y);
    });
    btn.setAttribute('data-direction', directions.shift().id);
    btn.classList.add('is-open');

});
btnYes.addEventListener('click', function (event) {
    btn.classList.remove('is-open');
    // alert('Yes Cliked');
    if (form_valid() == true) {
                perform_delete()
            }
    event.preventDefault();
});
btnNo.addEventListener('click', function (event) {
    btn.classList.remove('is-open');
    // alert('No clicked');
    event.preventDefault();
});
function distance(x1, y1, x2, y2) {
    var dx = x1 - x2;
    var dy = y1 - y2;
    return Math.sqrt(dx * dx + dy * dy);
}
{% endif %}
    {% endifequal %}


$(function(){
    $('#price').maskMoney();
  $("#phone").mask("(999) 999-9999");

  $("#phone").on("blur", function() {
      var last = $(this).val().substr( $(this).val().indexOf("-") + 1 );

      if( last.length == 5 ) {
          var move = $(this).val().substr( $(this).val().indexOf("-") + 1, 1 );

          var lastfour = last.substr(1,4);

          var first = $(this).val().substr( 0, 9 );

          $(this).val( first + move + '-' + lastfour );
      }
  });
});

$(document).ready(function () {
            $('#phone').mask('(000) 000-0000');


{#            var btn = document.querySelector( '.btn' );#}
{##}
{#            var btnFront = btn.querySelector( '.btn-front' ),#}
{#                btnYes = btn.querySelector( '.btn-back .yes' ),#}
{#                btnNo = btn.querySelector( '.btn-back .no' );#}

            $("#dialogschedulepopnewvendor").dialog({
                modal: true,
                {#                minHeight: 530,#}
                {#                minWidth: 634,#}
                minHeight: 520,
                minWidth: 670,
                resizable: false,
                draggable: false,
                autoOpen: false,
                dialogClass: "no-close",
                position: {
                    my: 'center',
                    at: 'center'
                },
            });

            $("#dialogschedulepopnewvendorcontact").dialog({
                modal: true,
                {#                minHeight: 530,#}
                {#                minWidth: 634,#}
                minHeight: 520,
                minWidth: 670,
                resizable: false,
                draggable: false,
                autoOpen: false,
                dialogClass: "no-close",
                position: {
                    my: 'center',
                    at: 'center'
                },
            });
{#            $("#id_schdeduledinputcal").datepicker({#}
{#            $("#id_schdeduledinputcal").datetimepicker({#}
{##}
{#                minDate: 0,#}
{#                showButtonPanel: true,#}
{#                changeMonth: true,#}
{#                changeYear: true,#}
{#                showAnim: "fold",#}
{#                                buttonImage: "images/calendar.gif",#}
{#                // The hidden field to receive the date#}
{#                format:'m/d/y H:i',#}
{#                format:'H:i',#}
{#                altField: "#id_schdeduledinputcal",#}
{#                // The format you want#}
{#                altFormat: "mm/dd/y",#}
{#                // The format the user actually sees#}
{#                dateFormat: "mm/dd/y",#}
{#                "minTime":"00:00",#}
{#                "maxTime":"23:59",#}
{##}
{#                onSelect: function (date) {#}
{##}
{#                    // Your CSS changes, just in case you still need them#}
{#                    $('a.ui-state-default').removeClass('ui-state-highlight');#}
{#                    $(this).addClass('ui-state-highlight');#}
{#                }#}
{#            });#}

            $("#id_schdeduledinputcal").datepicker({
                minDate: 0,
                showButtonPanel: true,
                changeMonth: true,
                changeYear: true,
                showAnim: "slide",
                // The hidden field to receive the date
                altField: "#id_schdeduledinputcal" ,
                // The format you want
                altFormat: "mm/dd/y",
                // The format the user actually sees
                dateFormat: "mm/dd/y",
                onSelect: function (date) {
                    // Your CSS changes, just in case you still need them
                    $('a.ui-state-default').removeClass('ui-state-highlight');
                    console.log('selected value',$(this).val());
{#                    var selectedactiondate = document.getElementById('id_schdeduledinputcal').val();#}
                    actiondate_mm = $(this).val().slice(0,2);
                    actiondate_dd = $(this).val().slice(3,5);
                    actiondate_yy = '20' + $(this).val().slice(6);
                    var selectedactiondate =actiondate_yy +'-'+ actiondate_mm +'-' +actiondate_dd;
                    document.getElementById('id_nextservicedate').value = setnextduedate(selectedactiondate);
                    console.log('selectedactiondate:', actiondate_mm,actiondate_dd ,actiondate_yy ,selectedactiondate );
                    console.log('Moment action',moment(selectedactiondate).add(moment.duration({M: 6})).format("MM-DD-YY"));
{#                    $(this).addClass('ui-state-highlight');#}
                }
            });

    if ( $('input:hidden[name=basi_code]').val() != 'ONCE')
    {

        $("#id_nextservicedate").datepicker({
            minDate: 0,
            showButtonPanel: true,
            changeMonth: true,
            changeYear: true,
            showAnim: "slide",
            // The hidden field to receive the date
            altField: "#id_nextservicedate",
            // The format you want
            altFormat: "mm/dd/y",
            // The format the user actually sees
            dateFormat: "mm/dd/y",
            onSelect: function (date) {

                // Your CSS changes, just in case you still need them
                $('a.ui-state-default').removeClass('ui-state-highlight');
                $(this).addClass('ui-state-highlight');
            }

        });
    }

        });


        {#        $('#id_schdeduledcalicon').click(function () {#}
        {##}
        {#            $("#id_schdeduledinputcal").datepicker();#}
        {#        });#}

        $('#createschedule').click(function () {
            {#        alert('1');#}
            $("#dialogrecactionpop").dialog("close");
            window.close();
        });

        function schedulepopupnewvendor(url) {
            $('#scddiv').hide();
            $('.ui-button.ui-corner-all.ui-widget').css('font-size', '14px');
            $('.ui-button.ui-corner-all.ui-widget').css('margin-left', '4px');

            $.ajax({
                url: url,
                success: function (data) {

                    console.log('url', url);
                    $("#scheduleIframe").attr("visibility", "hidden");
                    $("#dialogschedulepop").dialog("close");
                    $("#newvendorIframe").attr("src", url);
                    $("#newvendorIframe").attr("width", 670);
                    $("#newvendorIframe").attr("height", 520);
                    $("#newvendorIframe").attr("style", "border:None;font-family: Open Sans, sans-serif;");
                    $("#dialogschedulepopnewvendor").dialog("open");
                }
            });
            return false;
        }

        function schedulepopupnewvendorcontact(url) {
            $('#scddiv').hide();
            $('.ui-button.ui-corner-all.ui-widget').css('font-size', '14px');
            $('.ui-button.ui-corner-all.ui-widget').css('margin-left', '4px');

            $.ajax({
                url: url,
                success: function (data) {

                    console.log('url', url);
                    $("#scheduleIframe").attr("visibility", "hidden");
                    $("#dialogschedulepop").dialog("close");
                    $("#newvendorcontactIframe").attr("src", url);
                    $("#newvendorcontactIframe").attr("width", 670);
                    $("#newvendorcontactIframe").attr("height", 520);
                    $("#newvendorcontactIframe").attr("style", "border:None;font-family: Open Sans, sans-serif;");
                    $("#dialogschedulepopnewvendorcontact").dialog("open");
                }
            });
            return false;
        }

        $('#cancel').click(function () {
            if (window.parent.$("#dialogrecactionpop").dialog("isOpen") == true) {
                window.parent.$("#dialogrecactionpop").dialog("close");
            }
        });

        function ValidateEmail(email) {
            if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(email)) {
                return (true);
            }
            return (false);
        }


        function form_valid() {
            var form_valid = true;
{#            console.log($("#vendorlist option:selected").val());#}
            if ($("#vendorlist option:selected").val() == '') {
                form_valid = false;
                $('#vendorlist').addClass("oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-serviceprovider has-danger");

            } else {
                $('#vendorlist').removeClass("has-danger");
            }

            if ($("#vendorcontactlist option:selected").val() == '') {
                form_valid = false;
                $('#vendorcontactlist').addClass("oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-contact has-danger");

            } else {
                $('#vendorcontactlist').removeClass("has-danger");
            }

            if( document.getElementById("price").value == ''){
                document.getElementById("price").value =0;
            }

            var feedback1slected=false;
            document.getElementById("feedback_message").innerHTML='';
            var feedback1 = document.getElementsByName("feedback1");
            for(var i=0; i < feedback1.length; i++){
                if(feedback1[i].checked) {
                    feedback1radiochecked = i;
                    feedback1slected =true;
                }
            }

            if(feedback1slected==false)
            {
                for(var i=0; i < feedback1.length; i++){
                    feedback1[i].style= "box-shadow: 0px 0px 7px 4px rgba(230,9,52,1)";
                }
                document.getElementById("feedback_message").innerHTML="Please provide feedback";
                form_valid = false;
            }else{
                for(var i=0; i < feedback1.length; i++){
                    feedback1[i].style= "";
                }
            }

            var feedback2slected=false;
            var feedback2 = document.getElementsByName("feedback2");
            for(var i=0; i < feedback2.length; i++){
                if(feedback2[i].checked) {
                    feedback2radiochecked = i;
                    feedback2slected =true;
                }
            }

            if(feedback2slected==false)
            {
                for(var i=0; i < feedback2.length; i++){
                    feedback2[i].style= "box-shadow: 0px 0px 7px 4px rgba(230,9,52,1)";
                }
                document.getElementById("feedback_message").innerHTML="Please provide feedback";
                form_valid = false;
            }else{
                for(var i=0; i < feedback2.length; i++){
                    feedback2[i].style= "";
                }
            }

            var feedback3slected=false;
            var feedback3 = document.getElementsByName("feedback3");
            for(var i=0; i < feedback3.length; i++){
                if(feedback3[i].checked) {
                    feedback3radiochecked = i;
                    feedback3slected =true;
                }
            }

            if(feedback3slected==false)
            {
                for(var i=0; i < feedback3.length; i++){
                    feedback3[i].style= "box-shadow: 0px 0px 7px 4px rgba(230,9,52,1)";
                }
                document.getElementById("feedback_message").innerHTML="Please provide feedback";
                form_valid = false;
            }else{
                for(var i=0; i < feedback3.length; i++){
                    feedback3[i].style= "";
                }
            }

            if (document.getElementById('email').value != '') {
                if (ValidateEmail(document.getElementById('email').value) == false) {
                    form_valid = false;
                    $('#email').addClass("oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-email has-danger");
                } else {
                    $('#email').removeClass("has-danger");
                }
            }

            if ($('#id_schdeduledinputcal').hasClass("has-danger"))
                $('#id_schdeduledinputcal').removeClass("has-danger");
            document.getElementById("calendar_message").innerHTML = "";
            if (document.getElementById('id_schdeduledinputcal').value != '') {
                if (!moment(document.getElementById('id_schdeduledinputcal').value, 'MM/DD/YY', true).isValid()) {
                    form_valid = false;
                    $('#id_schdeduledinputcal').addClass("oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule hasDatepicker val-required has-danger");
                    document.getElementById("calendar_message").innerHTML = "Invalid scheduled date. Expected: MM/DD/YY";
                }
            } else {
                form_valid = false;
                $('#id_schdeduledinputcal').addClass("oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule hasDatepicker val-required has-danger");
            }

            if ($('#id_nextservicedate').hasClass("has-danger"))
                $('#id_nextservicedate').removeClass("has-danger");
            document.getElementById("calendar_message").innerHTML = "";
            if (document.getElementById('id_nextservicedate').value != '') {
                if (!moment(document.getElementById('id_nextservicedate').value, 'MM/DD/YY', true).isValid()) {
                    form_valid = false;
                    $('#id_nextservicedate').addClass("oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule hasDatepicker val-required has-danger");
                    document.getElementById("calendar_message").innerHTML = "Invalid scheduled date. Expected: MM/DD/YY";
                }
            } else {
                form_valid = false;
                $('#id_nextservicedate').addClass("oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule hasDatepicker val-required has-danger");
            }

            return form_valid;
        }

        function perform_updates(action) {
                document.getElementById("form_action_message").innerHTML = "";
                complianceservice_id = $('input:hidden[name=complianceservice_id]').val();
                basi_code = $('input:hidden[name=basi_code]').val();
                modified_cssc_id = $('input:hidden[name=modified_cssc_id]').val();
                actiontype = $('input:hidden[name=actiontype]').val();
                recordtype = $('input:hidden[name=recordtype]').val();
                recordtype_id = $('input:hidden[name=recordtype_id]').val();
{#                cres_id = $('input:hidden[name=cres_id]').val();#}
{#                console.log('cres_id--->',cres_id);#}
                vendor = $("#vendorlist option:selected").val();
                vendorcontactrole = $("#vendorcontactlist option:selected").val();
                phone = document.getElementById('phone').value;
                email = document.getElementById('email').value;
                price = document.getElementById('price').value;
            schdeduledinputcal = document.getElementById('id_schdeduledinputcal').value;
            nextservicedate = document.getElementById('id_nextservicedate').value;
            notes = document.getElementById('notes').value;
{#                console.log('Form Valid -AJAX- Create action call,responsible',responsible);#}
                $.ajax({
                    url: 'ajax_complianceservice_addnewaction',
                    data: {
                        'action':action,
                        'complianceservice_id':complianceservice_id,
                        'basi_code':basi_code,
                        'modified_cssc_id':modified_cssc_id,
                        'actiontype':actiontype,
                        'recordtype': recordtype,
                        'recordtype_id': recordtype_id,
                        'vendor': vendor,
                        'vendorcontactrole': vendorcontactrole,
                        'phone': phone,
                        'email': email,
                        'notes': notes,
                        'actiondate':schdeduledinputcal,
                        'nextservicedate':nextservicedate,
                        'price':price
                    },
                    dataType: 'json',
                    success: function (response_data) {
                        console.log(response_data.result);
                        if (response_data.result == 'success') {
                            window.parent.$("#dialogrecactionpop").dialog("close");
                            window.parent.location.reload();
                        }

                    }
                });
        }

        function perform_delete() {
            console.log('All welll for Data updated');
                document.getElementById("form_action_message").innerHTML = "";
                action ='delete';
                modified_cssc_id = $('input:hidden[name=modified_cssc_id]').val();
                actiontype = $('input:hidden[name=actiontype]').val();
                recordtype = $('input:hidden[name=recordtype]').val();
                recordtype_id = $('input:hidden[name=recordtype_id]').val();
                vendor = $("#vendorlist option:selected").val();
                vendorcontactrole = $("#vendorcontactlist option:selected").val();
                phone = document.getElementById('phone').value;
                email = document.getElementById('email').value;
                schedule = document.getElementById('id_schdeduledinputcal').value;
                notes = document.getElementById('notes').value;
{#                responsible = $("#responsiblelist option:selected").val();#}
                console.log('Form Valid -AJAX- Create Vendor call');
                $.ajax({
                    url: 'ajax_complianceservice_addnewschedule',
                    data: {
                        'action':action,
                        'modified_cssc_id':modified_cssc_id,
                        'actiontype':actiontype,
                        'recordtype': recordtype,
                        'recordtype_id': recordtype_id,
                        'vendor': vendor,
                        'vendorcontactrole': vendorcontactrole,
                        'phone': phone,
                        'email': email,
                        'schedule': schedule,
                        'notes': notes,
                        'responsible': responsible
                    },
                    dataType: 'json',
                    success: function (response_data) {
                        console.log(response_data.result);
                        if (response_data.result == 'success') {
                            document.getElementById("form_action_message").innerHTML = "";
                            window.parent.$("#dialogrecactionpop").dialog("close");
                            window.parent.location.reload();
                        }
                        if (response_data.result == 'error') {
                            document.getElementById("form_action_message").innerHTML = " Error: "+response_data.error_message;
                        }

                    }
                });

        }

        $('#createaction').click(function () {
            if (form_valid() == true) {
                perform_updates('create')
            }
        });

         $('#updateaction').click(function () {
            if (form_valid() == true) {
                perform_updates('update')
            }
        });

        $('#deleteaction').click(function () {
            if (form_valid() == true) {
                perform_delete()
            }
        });

$('#vendorlist').on('change', function() {

    $('#vendorlist').removeClass("has-danger");
    console.log($("#vendorlist option:selected").val());

if($("#vendorlist option:selected").val() != '')
    {
{#        $("#vendorcontactlist")[0].selectedIndex = 1;#}
        $('#phone').text('');
        $('#email').text('');
        $('#vendorcontactlist').find('option').remove().end();
{#        document.getElementById('id_lastservicedate').value ='';#}

        $.ajax({
            url: '/app/schedule/ajax_vendorcontactlist',
            data: {
                'vendorselected': $("#vendorlist option:selected").val(),
            },
            dataType: 'json',
            success: function (response_data) {
                console.log(response_data.result);
                if (response_data.result == 'success' ) {

{#                    $("div.f_inp_bx select").val(response_data['frequency']);#}
{#                    $('#jurisdiction').text(response_data['jurisdiction']);#}
{#                    $('#servicedesc').text(response_data['compliance_desc']);#}
                    document.getElementById('phone').value =response_data['phone'];
                    document.getElementById('email').value =response_data['email'];
                    $('#vendorcontactlist').removeAttr('disabled');
                    $.each(response_data.vendorcontact, function (key, value) {
                        $('#vendorcontactlist').append(
                                $("<option></option>")
                                        .attr("value", value[0])
                                        .text(value[1])
                        );
                    });
{#                    $('#id_cityopt').append('<option value="add">Add city</option>').val('add');#}
                    $("#vendorcontactlist")[0].selectedIndex = 0;

                    }

            }
         });
    }
    else{
        $('#vendorlist').addClass("oh_scd_servkeeComponent oh_scd_servkeeCombobox newscd-dropdown-serviceprovider  has-danger");
        $('#phone').text('');
        $('#email').text('');
        $("#vendorlist")[0].selectedIndex = 0;
{#        document.getElementById('id_lastservicedate').value ='';#}
    }

});

$('#vendorcontactlist').on('change', function() {

    $('#vendorcontactlist').removeClass("has-danger");
    if($("#vendorcontactlist option:selected").val() != '')
        {
            $('#phone').text('');
            $('#email').text('');
            $.ajax({
                url: 'ajax_vendorcontactdetails',
                data: {
                    'vendorselected': $("#vendorlist option:selected").val(),
                    'vendorselectedcontact': $("#vendorcontactlist option:selected").val()
                },
                dataType: 'json',
                success: function (response_data) {
                    console.log(response_data.result);
                    if (response_data.result == 'success' ) {
                        document.getElementById('phone').value =response_data['phone'];
                        document.getElementById('email').value =response_data['email'];
                        }
                }
             });
        }
});

function addDays(days) {
    if($('input:hidden[name=basi_code]').val() != '') {
        if (document.getElementById('id_schdeduledinputcal').value != '') {
            console.log(document.getElementById('id_schdeduledinputcal').value);
            var nextduedate = new Date(document.getElementById('id_schdeduledinputcal').value);
            var lastservicedate = new Date(nextduedate.getTime() + (days * 24 * 60 * 60 * 1000));
            return lastservicedate;
        }
        return new Date(new Date().getTime() + (days * 24 * 60 * 60 * 1000));
    }
}

{#$('#id_schdeduledinputcal').on('focusout', function() {#}
{##}
{#    $('#id_schdeduledinputcal').removeClass("has-danger");#}
{#    recordtype = $('input:hidden[name=recordtype]').val();#}
{#    alert($('input:hidden[name=basi_code]').val());#}
{##}
{#if($('input:hidden[name=basi_code]').val() != '')#}
{#    {#}
{#        console.log($('input:hidden[name=basi_code]').val());#}
{#          switch ($('input:hidden[name=basi_code]').val()) {#}
{#                case 'DAILY':#}
{#                    var tomorrow = addDays(1);#}
{#                    tomorrow_dd = ("0" + tomorrow.getDate()).slice(-2);#}
{#                    tomorrow_mm = ("0" + (tomorrow.getMonth() + 1)).slice(-2);#}
{#                    tomorrow_yy = ("0" + (tomorrow.getYear())).slice(-2);#}
{#                    tomorrow = tomorrow_mm + '/' + tomorrow_dd + '/' + tomorrow_yy;#}
{#                    document.getElementById('id_nextservicedate').value = tomorrow;#}
{#                    break;#}
{##}
{#                case 'WEEKLY':#}
{#                    var nextweek = addDays(7);#}
{#                    nextweek_dd = ("0" + nextweek.getDate()).slice(-2);#}
{#                    nextweek_mm = ("0" + (nextweek.getMonth() + 1)).slice(-2);#}
{#                    nextweek_yy = ("0" + (nextweek.getYear())).slice(-2);#}
{#                    nextweek = nextweek_mm + '/' + nextweek_dd + '/' + nextweek_yy;#}
{#                    document.getElementById('id_nextservicedate').value = nextweek;#}
{#                    break;#}
{##}
{#                case 'MNTHLY':#}
{#                    var nextmonth = addDays(30);#}
{#                    nextmonth_dd = ("0" + nextmonth.getDate()).slice(-2);#}
{#                    nextmonth_mm = ("0" + (nextmonth.getMonth() + 1)).slice(-2);#}
{#                    nextmonth_yy = ("0" + (nextmonth.getYear())).slice(-2);#}
{#                    nextmonth = nextmonth_mm + '/' + nextmonth_dd + '/' + nextmonth_yy;#}
{#                    document.getElementById('id_nextservicedate').value = nextmonth;#}
{#                    break;#}
{##}
{#                case 'QTLY':#}
{#                    var nextquarter = addDays(90);#}
{#                    nextquarter_dd = ("0" + nextquarter.getDate()).slice(-2);#}
{#                    nextquarter_mm = ("0" + (nextquarter.getMonth() + 1)).slice(-2);#}
{#                    nextquarter_yy = ("0" + (nextquarter.getYear())).slice(-2);#}
{#                    nextquarter = nextquarter_mm + '/' + nextquarter_dd + '/' + nextquarter_yy;#}
{#                    document.getElementById('id_nextservicedate').value = nextquarter;#}
{#                    break;#}
{##}
{#                case 'SEMIAN':#}
{##}
{#                    var nextsemian = addDays(0);#}
{##}
{##}
{#                    nextsemian_dd = ("0" + nextsemian.getDate()).slice(-2);#}
{#                    nextsemian_mm = ("0" + (nextsemian.getMonth() + 1)).slice(-2);#}
{#                    nextsemian_yy = ("0" + (nextsemian.getYear())).slice(-2);#}
{#                    nextsemian = nextsemian_mm + '/' + nextsemian_dd + '/' + nextsemian_yy;#}
{#                    console.log(moment().add(6, 'M').format('MM-DD-YY'));#}
{#                    var currentDate = moment().format('DD-MM-YYYY');#}
{#                    console.log(document.getElementById('id_schdeduledinputcal').textContent);#}
{#                    var selectedactiondate = document.getElementById('id_schdeduledinputcal').val();#}
{#                    console.log('selectedactiondate Actual:', selectedactiondate);#}
{#                    actiondate_mm = selectedactiondate.slice(0,1);#}
{#                    actiondate_dd = selectedactiondate.slice(3,4);#}
{#                    actiondate_yy = selectedactiondate.slice(6);#}
{#                    console.log('selectedactiondate:', actiondate_mm,actiondate_dd ,actiondate_yy);#}
{#                    console.log('Moment action',moment([actiondate_yy,actiondate_mm,actiondate_dd]).add(6, 'months').format("MM-DD-YY"))#}
{#                    document.getElementById('id_nextservicedate').value= moment([actiondate_yy,actiondate_mm,actiondate_dd]).month(6).format("MM-DD-YY");#}
{#                    document.getElementById('id_nextservicedate').value = nextsemian;#}
{#                    break;#}
{##}
{#                case 'ANNUAL':#}
{#                    var nextannual = addDays(365);#}
{#                    nextannual_dd = ("0" + nextannual.getDate()).slice(-2);#}
{#                    nextannual_mm = ("0" + (nextannual.getMonth() + 1)).slice(-2);#}
{#                    nextannual_yy = ("0" + (nextannual.getYear())).slice(-2);#}
{#                    nextannual = nextannual_mm + '/' + nextannual_dd + '/' + nextannual_yy;#}
{#                    document.getElementById('id_nextservicedate').value = nextannual;#}
{#                    break;#}
{##}
{#                case 'BIEN':#}
{#                    var nextbien = addDays(730);#}
{#                    nextbien_dd = ("0" + nextbien.getDate()).slice(-2);#}
{#                    nextbien_mm = ("0" + (nextbien.getMonth() + 1)).slice(-2);#}
{#                    nextbien_yy = ("0" + (nextbien.getYear())).slice(-2);#}
{#                    nextbien = nextbien_mm + '/' + nextbien_dd + '/' + nextbien_yy;#}
{#                    document.getElementById('id_nextservicedate').value = nextbien;#}
{#                    break;#}
{##}
{#                case 'ONCE':#}
{#                    break;#}
{##}
{#                case 'CUSTOM':#}
{#                    break;#}
{##}
{#            }#}
{#    }else{#}
{#        if($("#id_complianceservice option:selected").val() != '')#}
{#            $('#id_complianceservice').addClass("inp_card_info_city_dropdown  has-danger");#}
{##}
{#        $('#id_frequency').addClass("inp_card_info_city_dropdown  has-danger");#}
{# } #}
{##}
{# {);#}

function setnextduedate(selectedactiondate){

$('#id_schdeduledinputcal').removeClass("has-danger");
{#    recordtype = $('input:hidden[name=recordtype]').val();#}
{#    alert($('input:hidden[name=basi_code]').val());#}

if($('input:hidden[name=basi_code]').val() != '')
    {
        console.log($('input:hidden[name=basi_code]').val());
          switch ($('input:hidden[name=basi_code]').val()) {
                case 'DAILY':
                    return moment(selectedactiondate).add(moment.duration({D: 1})).format("MM/DD/YY");
                    break;

                case 'WEEKLY':
                    return moment(selectedactiondate).add(moment.duration({D: 7})).format("MM/DD/YY");
                    break;

                case 'MNTHLY':
                    return moment(selectedactiondate).add(moment.duration({M: 1})).format("MM/DD/YY");
                    break;

                case 'QTLY':
                    return moment(selectedactiondate).add(moment.duration({M: 3})).format("MM/DD/YY");
                    break;

                case 'SEMIAN':
                    return moment(selectedactiondate).add(moment.duration({M: 6})).format("MM/DD/YY");
                    break;

                case 'ANNUAL':
                    return moment(selectedactiondate).add(moment.duration({Y: 1})).format("MM/DD/YY");
                    break;

                case 'BIEN':
                    return moment(selectedactiondate).add(moment.duration({Y: 2})).format("MM/DD/YY");
                    break;

                case 'ONCE':
{#                    return moment(new Date(2099-12-31)).format("MM/DD/YY");#}
                    return "12/31/99";
                    break;


                case 'CUSTOM':
                    return moment(selectedactiondate).add(moment.duration({Y: 1})).format("MM/DD/YY");
                    break;

            }
    }else{
        if($("#id_complianceservice option:selected").val() != '')
            $('#id_schdeduledinputcal').addClass("oh_scd_servkeeComponent oh_scd_servkeeTextinput newscd-input-schedule hasDatepicker  ui-state-highlight");
            return moment(selectedactiondate).add(moment.duration({D: 0})).format("MM/DD/YY");
}

}
</script>
{% endblock %}
